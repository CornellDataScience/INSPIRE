---
title: "R Notebook"
output: html_notebook
---


```{r}
library(data.table)
library(tidyverse)
library(rjson)
library(corrplot)
spore <- fread("song_data.csv")
summary(spore)
head(spore)
nrow(spore)
n_distinct(spore$id)
```
We are given a dataset with 2555 distinct songs, each with 13 numerical descriptives.
```{r}
numerical_spore = spore[, c("id", "acousticness", "danceability", "duration_ms", "energy", "instrumentalness", "liveness", "loudness", "mode", "speechiness", "tempo", "valence")]
heatmap(as.matrix(numerical_spore[, -c("id")]), scale = "column") #heatmap test (bad)
corrmat <- cor(numerical_spore[,-c("id")], method = "pearson", use = "complete.obs")

#Calculate matrix p values
cor.mtest <- function(mat, ...) {
    mat <- as.matrix(mat)
    n <- ncol(mat)
    p.mat<- matrix(NA, n, n)
    diag(p.mat) <- 0
    for (i in 1:(n - 1)) {
        for (j in (i + 1):n) {
            tmp <- cor.test(mat[, i], mat[, j], ...)
            p.mat[i, j] <- p.mat[j, i] <- tmp$p.value
        }
    }
  colnames(p.mat) <- rownames(p.mat) <- colnames(mat)
  p.mat
}
col <- colorRampPalette(c("#BB4444", "#EE9988", "#FFFFFF", "#77AADD", "#4477AA"))
corrplot(corrmat, method = "color")
corrplot(corrmat, method = "number", col = col(200), type = "upper")

```

```{r}
names(spore)
df = spore %>%
  group_by(id) %>%
  summarise(
    dance_to_length = danceability/duration_ms,
    speech_to_acoustics = speechiness/acousticness,
    energy_to_liveness = energy/liveness,
    noise = loudness/energy,
    speed = tempo/duration_ms,
    valence
  )
```

